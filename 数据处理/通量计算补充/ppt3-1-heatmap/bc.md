```py
gsva = pd.read_csv("/public/home/yuwenqi/sc-data/selected/Breast/workspace2/BC3-CCI/module/module/cci_an_sheet/gsva/all2.csv", index_col = 0).T
meta = pd.read_csv("/public/home/yuwenqi/sc-data/selected/Breast/workspace2/BC3-CCI/module/bc3_meta_all2.csv", index_col=0)
meta_t = meta.loc[meta.Tissue == 'Tumor']
meta_use = meta_t.loc[meta_t.cluster == 'Mye']

gsva = gsva.loc[gsva.index.isin(meta_use.index), ['M1 Macrophage Polarization', 'Pro-inflammatory in myeloid cells', 'M2 Macrophage Polarization', 'Anti-inflammatory in myeloid cells', 'Angiogenesis']]
gsva['ident'] = meta.loc[gsva.index, 'sub_cluster']
res = gsva.groupby('ident').mean().T
res.to_csv("/public/home/yuwenqi/sc-data/selected/append_ana/pathway_appends/PPT3-1-heatmap/bc/plot_data.csv")
```

```R
data = read.csv("/public/home/yuwenqi/sc-data/selected/append_ana/pathway_appends/PPT3-1-heatmap/bc/plot_data.csv", row.names=1)
heatmap = pheatmap(data, 
                   #annotation_row = annotation, # ?????????????????????????????????
                   #annotation_col=col, # ?????????????????????????????????
                   #show_colnames = TRUE, # ??????????????????
                   #show_rownames=TRUE,  # ??????????????????
                   fontsize=10, # ????????????
                   color = colorRampPalette(c("#191970","#FDF5E6",'#B22222'))(100), # ?????????????????????
                   annotation_legend=TRUE, # ??????????????????
                   border_color=NA,  # ???????????? NA????????????
                   scale="row",  # ???????????????????????????"row"??????????????????"column"??????????????????"none"?????????
                   cluster_rows = FALSE, # ??????????????????
                   cluster_cols = FALSE, # ??????????????????
                   #legend_breaks = c(min(data), max(data)),
                   #legend_labels = c('',''),
                   cellheight = 26,
                   cellwidth = 26,
                   angle_col = 45,
                   fontsize_col = 10,
                   fontsize_row =10,
                   gaps_row = 1:length(rownames(data)),
                   gaps_col = 1:length(colnames(data)),
                   
)
ggsave(filename = "/public/home/yuwenqi/sc-data/selected/append_ana/pathway_appends/PPT3-1-heatmap/bc/plot.pdf", plot = heatmap, device = 'pdf', width = 10, height = 10, units = 'in')
```