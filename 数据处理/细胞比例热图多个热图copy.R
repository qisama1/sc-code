

data = read.csv("/public/home/yuwenqi/sc-data/selected/new-RNAseq/COAD/gsva/crc_ssgsea_subTME_filted.csv", row.names=1)
bk <- c(seq(min(data), -0.001, (0 - min(data)) / 100),seq(0, max(data), (max(data) - 0) / 100))

heatmap1 = pheatmap(data, 
                    #annotation_row = annotation, # ?????????????????????????????????
                    #annotation_col=anno, # ?????????????????????????????????
                    show_colnames = T, # ??????????????????
                    #show_rownames=TRUE,  # ??????????????????
                    fontsize=10, # ????????????
                    breaks = bk,
                    color = c(colorRampPalette(c("#0c00e6","#FFFFFF"))(length(bk) / 2), colorRampPalette(colors=c('#FFFFFF', '#e00000'))(length(bk) / 2)), # ?????????????????????#color = colorRampPalette(c("#0c00e6",'#FFFFFF',"#e00000"))(100),
                    annotation_legend=TRUE, # ??????????????????
                    border_color=NA,  # ???????????? NA????????????
                    scale="column",  # ???????????????????????????"row"??????????????????"column"??????????????????"none"?????????
                    cluster_rows = F, # ??????????????????
                    cluster_cols = F, # ??????????????????
                    legend_breaks = c(min(data), 0, max(data)),
                    legend_labels = c(round(min(data), 2),0,round(max(data), 2)),
                    cellheight = 20,
                    cellwidth = 20,
                    angle_col = 45,
                    fontsize_col = 12,
                    fontsize_row =12,
                    #display_numbers = T,
                    #gaps_row = c(3,6,9,12,15)
                    #gaps_row = 1:length(rownames(data)),
                    #gaps_col = c(1,2,3)
                    
)

data = read.csv("/public/home/yuwenqi/sc-data/selected/new-RNAseq/PDAC/ssgsea/corr_res3.csv", row.names=1)
bk <- c(seq(min(data), -0.001, (0 - min(data)) / 100),seq(0, max(data), (max(data) - 0) / 100))
heatmap2 = pheatmap(data, 
                    #annotation_row = annotation, # ?????????????????????????????????
                    #annotation_col=anno, # ?????????????????????????????????
                    show_colnames = T, # ??????????????????
                    #show_rownames=TRUE,  # ??????????????????
                    fontsize=10, # ????????????
                    breaks = bk,
                    color = c(colorRampPalette(c("#0c00e6","#FFFFFF"))(length(bk) / 2), colorRampPalette(colors=c('#FFFFFF', '#e00000'))(length(bk) / 2)), # ?????????????????????#color = colorRampPalette(c("#0c00e6",'#FFFFFF',"#e00000"))(100),
                    annotation_legend=TRUE, # ??????????????????
                    border_color=NA,  # ???????????? NA????????????
                    scale="column",  # ???????????????????????????"row"??????????????????"column"??????????????????"none"?????????
                    cluster_rows = F, # ??????????????????
                    cluster_cols = F, # ??????????????????
                    legend_breaks = c(min(data), 0, max(data)),
                    legend_labels = c(round(min(data), 2),0,round(max(data), 2)),
                    cellheight = 20,
                    cellwidth = 20,
                    angle_col = 45,
                    fontsize_col = 12,
                    fontsize_row =12,
                    #display_numbers = T,
                    #gaps_row = c(3,6,9,12,15)
                    #gaps_row = 1:length(rownames(data)),
                    #gaps_col = c(1,2,3)
                    
)

data = read.csv("/public/home/yuwenqi/sc-data/selected/new-RNAseq/BRCA/ssgsea/brca_ssgsva_corr_res3.csv",row.names=1)
bk <- c(seq(min(data), -0.001, (0 - min(data)) / 100),seq(0, max(data), (max(data) - 0) / 100))
heatmap3 = pheatmap(data, 
                    #annotation_row = annotation, # ?????????????????????????????????
                    #annotation_col=anno, # ?????????????????????????????????
                    show_colnames = T, # ??????????????????
                    #show_rownames=TRUE,  # ??????????????????
                    fontsize=10, # ????????????
                    breaks = bk,
                    color = c(colorRampPalette(c("#0c00e6","#FFFFFF"))(length(bk) / 2), colorRampPalette(colors=c('#FFFFFF', '#e00000'))(length(bk) / 2)), # ?????????????????????#color = colorRampPalette(c("#0c00e6",'#FFFFFF',"#e00000"))(100),
                    annotation_legend=TRUE, # ??????????????????
                    border_color=NA,  # ???????????? NA????????????
                    scale="column",  # ???????????????????????????"row"??????????????????"column"??????????????????"none"?????????
                    cluster_rows = F, # ??????????????????
                    cluster_cols = F, # ??????????????????
                    legend_breaks = c(min(data), 0, max(data)),
                    legend_labels = c(round(min(data), 2),0,round(max(data), 2)),
                    cellheight = 20,
                    cellwidth = 20,
                    angle_col = 45,
                    fontsize_col = 12,
                    fontsize_row =12,
                    #display_numbers = T,
                    #gaps_row = c(3,6,9,12,15)
                    #gaps_row = 1:length(rownames(data)),
                    #gaps_col = c(1,2,3)
                    
)
data = read.csv("/public/home/yuwenqi/sc-data/selected/new-RNAseq/ESCA/ssgsea/esca_ssgsva_corr_res3.csv",row.names=1)
bk <- c(seq(min(data), -0.001, (0 - min(data)) / 100),seq(0, max(data), (max(data) - 0) / 100))
heatmap4 = pheatmap(data, 
                    #annotation_row = annotation, # ?????????????????????????????????
                    #annotation_col=anno, # ?????????????????????????????????
                    show_colnames = T, # ??????????????????
                    #show_rownames=TRUE,  # ??????????????????
                    fontsize=10, # ????????????
                    breaks = bk,
                    color = c(colorRampPalette(c("#0c00e6","#FFFFFF"))(length(bk) / 2), colorRampPalette(colors=c('#FFFFFF', '#e00000'))(length(bk) / 2)), # ?????????????????????#color = colorRampPalette(c("#0c00e6",'#FFFFFF',"#e00000"))(100),
                    annotation_legend=TRUE, # ??????????????????
                    border_color=NA,  # ???????????? NA????????????
                    scale="column",  # ???????????????????????????"row"??????????????????"column"??????????????????"none"?????????
                    cluster_rows = F, # ??????????????????
                    cluster_cols = F, # ??????????????????
                    legend_breaks = c(min(data), 0, max(data)),
                    legend_labels = c(round(min(data), 2),0,round(max(data), 2)),
                    cellheight = 20,
                    cellwidth = 20,
                    angle_col = 45,
                    fontsize_col = 12,
                    fontsize_row =12,
                    #display_numbers = T,
                    #gaps_row = c(3,6,9,12,15)
                    #gaps_row = 1:length(rownames(data)),
                    #gaps_col = c(1,2,3)
                    
)
p = cowplot::plot_grid(heatmap1$gtable, heatmap2$gtable, heatmap3$gtable, heatmap4$gtable,
                   nrow = 4, labels=LETTERS[1:4])
ggsave(filename = "/public/home/yuwenqi/sc-data/selected/new-RNAseq/heatmap_gsva/gsva_heatmap_all.pdf", plot = p , device = 'pdf', width = 18, height = 30, units = 'cm')



