data = read.csv("/public/home/yuwenqi/sc-data/selected/append_ana/subTME-heatmap-TAM-cancer/bc/plot_data.csv", row.names=1)

an = read.csv("/public/home/yuwenqi/sc-data/selected/append_ana/subTME-heatmap-TAM-cancer/bc/an.csv", row.names = 1)
rownames(an) = colnames(data)
bk <- c(seq(min(data), -0.001, (0 - min(data)) / 100),seq(0, max(data), (max(data) - 0.001) / 100))

heatmap = pheatmap(data, 
                   #annotation_row = annotation, # ?????????????????????????????????
                   annotation_col=an, # ?????????????????????????????????
                   show_colnames = F, # ??????????????????
                   #show_rownames=TRUE,  # ??????????????????
                   fontsize= 10, # ????????????
                   breaks = bk,
                   color = c(colorRampPalette(c("#0c00e6"))(length(bk) / 2), colorRampPalette(c("#0c00e6","#FFFFFF"))(length(bk) / 4), colorRampPalette(colors=c('#FFFFFF', '#e00000'))(length(bk) / 4), colorRampPalette(colors=c('#e00000'))(length(bk) / 4)), # ?????????????????????
                   #color = colorRampPalette(c("#FFFFFF","#e00000"))(100),
                   annotation_legend=TRUE, # ??????????????????
                   border_color=NA,  # ???????????? NA????????????
                   scale="none",  # ???????????????????????????"row"??????????????????"column"??????????????????"none"?????????
                   cluster_rows = FALSE, # ??????????????????
                   cluster_cols = FALSE, # ??????????????????
                   legend_breaks = c(min(data), 0, max(data) - 0.01),
                   legend_labels = c(round(min(data), 1),0,round(max(data) - 0.01, 1)),
                   cellheight = 12,
                   cellwidth = 4,
                   angle_col = 45,
                   fontsize_col = 10,
                   fontsize_row = 10,
                   #gaps_row = c(5,9, 15, 19, 21, 24, 25)
                   #gaps_row = 1:length(rownames(data)),
                   #gaps_col = c(4, 8, 12, 16)
                   
)

pdf("/public/home/yuwenqi/sc-data/selected/append_ana/subTME-heatmap-TAM-cancer/bc/bc_heatmap_TAM.pdf", width = 10 , height = 10)
heatmap
dev.off()